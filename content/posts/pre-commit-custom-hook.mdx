---
title: pre-commit custom hook ë§Œë“¤ê¸°
description: pre-commitì€ Git ì›ê²© ì €ì¥ì†Œì— ì»¤ë°‹í•˜ê¸° ì „, ì‹¤í–‰ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ êµ¬ì„±í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” toolì…ë‹ˆë‹¤. ì˜¤ëŠ˜ì€ pre-commitì—ì„œ custom hookì„ ë§Œë“œëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ë ¤ê³  í•©ë‹ˆë‹¤.
tags: [pre-commit]
author: mingke
thumbnail: /thumbnails/pre-commit-logo.png
date: 2024/01/26
---

<Image src="/thumbnails/pre-commit-logo.png" alt="pre-commit logo" />

### ëª©ì°¨

## ì†Œê°œ

pre-commitì€ Git ì›ê²© ì €ì¥ì†Œì— ì»¤ë°‹í•˜ê¸° ì „, ì‹¤í–‰ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ êµ¬ì„±í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” toolì…ë‹ˆë‹¤. pre-commitì„ ì‚¬ìš©í•˜ì—¬ ì½”ë“œ ì •ì  ë¶„ì„, ì½”ë“œ ìŠ¤íƒ€ì¼ ê²€ì‚¬, í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë“± ë‹¤ì–‘í•œ ì‘ì—…ì„ ìë™í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ì€ pre-commitì—ì„œ custom hookì„ ë§Œë“œëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ë ¤ê³  í•©ë‹ˆë‹¤. pre-commitì´ ë¬´ì—‡ì¸ì§€, ê¸°ë³¸ ì‚¬ìš©ë²•ì„ ìì„¸í•˜ê²Œ ì•Œê³  ì‹¶ì€ ë¶„ë“¤ì€ ê³µì‹ ë¬¸ì„œë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”.

<Link url="https://pre-commit.com" />

## Pre-commit Custom hook ë§Œë“¤ê¸°

pre-commit custom hookì€ ë‹¤ì–‘í•œ ì–¸ì–´ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. Python, JavaScript, Ruby, Go, Bash ë“± ì›í•˜ëŠ” ì–¸ì–´ë¡œ ë§Œë“¤ë©´ ë©ë‹ˆë‹¤.

ì €ëŠ” ë³´í†µ í”„ë¡œì íŠ¸ì—ì„œ `scripts` ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“¤ì–´ì„œ ê·¸ì•ˆì— ì €ì¥í•˜ëŠ”í¸ì…ë‹ˆë‹¤. ì‹¤ì œë¡œ ì‚¬ìš©í–ˆë˜ ê°„ë‹¨í•œ ì‚¬ë¡€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

- poetryë¡œ ì˜ì¡´ì„±ì„ ê´€ë¦¬í•˜ê³  ìˆëŠ”ë° ì•ˆì“°ëŠ” ì‚¬ëŒë“¤ì„ ìœ„í•´ requirements.txtë¥¼ ë§Œë“¤ì–´ pushí•˜ëŠ” ìƒí™©
- ê·¸ëŸ°ë° poetry add or updateë¥¼ ì‚¬ìš©í•œ ë’¤ requirements.txt ì—…ë°ì´íŠ¸ë¥¼ ìê¾¸ë§Œ ìŠì–´ë²„ë¦¼
- commitì„ í•˜ë©° requirements.txtë¥¼ ì—…ë°ì´íŠ¸ í•˜ë„ë¡ í›…ì„ ë§Œë“¬

### ì˜ˆì‹œ ì½”ë“œ

- requirements.txt ëŠ” rootì— ì¡´ì¬

```bash
# scripts/check_requirements.sh
#!/bin/bash

cp requirements.txt requirements.txt.bak

poetry export -f requirements.txt --output requirements.txt --without-hashes

# ì›ë³¸ê³¼ ì—…ë°ì´íŠ¸ëœ íŒŒì¼ì„ ë¹„êµ.
if ! cmp -s requirements.txt.bak requirements.txt; then
    echo "Requirements updated, Add the changes to commit."
    rm requirements.txt.bak
    exit 1
fi

# ë³€ê²½ ì‚¬í•­ì´ ì—†ìœ¼ë©´ ë³µì‚¬ë³¸ì„ ì‚­ì œí›„ ì¢…ë£Œ.
rm requirements.txt.bak
echo "Nothing to change in requirements.txt"
exit 0
```

1. requirements.txtë¥¼ ë°±ì—…í•©ë‹ˆë‹¤.
2. requirements.txt ì—…ë°ì´íŠ¸ë¥¼ ì‹œë„í•©ë‹ˆë‹¤.
3. ë°±ì—…ë³¸ê³¼ ë¹„êµí•˜ì—¬ ì—…ë°ì´íŠ¸ê°€ ìˆì—ˆëŠ”ì§€ ì²´í¬í•©ë‹ˆë‹¤.
4. ìˆìœ¼ë©´ pre-commit ì‹¤íŒ¨ ì—†ìœ¼ë©´ ì„±ê³µ

- **ì‹¤í–‰ê¶Œí•œì„ ë°˜ë“œì‹œ ì¤˜ì•¼ pre-commitì´ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.**

```bash
chmod +x /scripts/check_requirements.sh
```

### .pre-commit-config.yamlì— ë“±ë¡

- ì•„ë˜ì™€ ê°™ì´ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```yaml
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-added-large-files
  - repo: https://github.com/psf/black
    rev: 22.3.0
    hooks:
      - id: black
        args: [--line-length=120]
  - repo: https://github.com/PyCQA/flake8
    rev: 7.0.0
    hooks:
      - id: flake8
  - repo: local
    hooks:
      - id: check-and-update-requirements
        name: Check requirements.txt
        entry: ./scripts/check_requirements.sh
        language: script
```

- `pre-commit install`í•˜ì—¬ hookë“¤ì„ ë“±ë¡í•©ë‹ˆë‹¤.

<Callout emoji="ğŸ’¡">
ë§Œì•½ pythonìœ¼ë¡œ ë§Œë“ ë‹¤ë©´ entryë¥¼ python fileì´ë¦„.pyë¡œ ë³€ê²½í•˜ê³   languageë¥¼ pythonìœ¼ë¡œ ë³€ê²½

</Callout>

### ì‹¤í–‰ê²°ê³¼

ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•©ë‹ˆë‹¤.

- ì‹¤íŒ¨

  <Image src="/pre-commit-custom-hook/01.png" alt="pre-commit fail" />

- ì„±ê³µ
  <Image src="/pre-commit-custom-hook/02.png" alt="pre-commit success" />

## ë§ˆë¬´ë¦¬

pre-commitì— ì»¤ìŠ¤í…€ í›…ì„ ë“±ë¡í•´ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤. pre-commitì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ë‹¤ì–‘í•œ í›…ë“¤ì„ ì œê³µí•˜ëŠ”ë° ì´ê²ƒë„ ì‚´í´ë³´ëŠ” ê²ƒë„ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì“¸ë§Œí•œ hook ì•„ì´ë””ì–´ê°€ ìƒê°ë‚˜ë©´ ë§Œë“¤ì–´ë´ì•¼ê² ìŠµë‹ˆë‹¤.

<Link url="https://github.com/pre-commit/pre-commit-hooks/tree/main/pre_commit_hooks" />
