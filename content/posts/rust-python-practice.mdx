---
title: Rustë¡œ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§Œë“¤ì–´ë³´ê¸°(PyO3)
description: ì·¨ë¯¸ë¡œ Rustë¥¼ ê³µë¶€í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ì œ ì–´ëŠ ì •ë„ ê¸°ë³¸ì ì¸ ë¬¸ë²•ì„ ìµí˜”ê³ , Rustì½”ë“œë¥¼ ì¡°ê¸ˆì€ ì½ì„ ìˆ˜ ìˆê²Œë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ Rustë¡œ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§Œë“¤ê¸° Hello World ì •ë„ë¥¼ í•œ ë²ˆ í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.
tags: [Python, Rust]
author: mingke
thumbnail: /thumbnails/rust-logo.png
date: 2024/06/01
---

<Image src="/thumbnails/rust-logo.png" alt="Rust Python PyO3" />

### ëª©ì°¨

## PyO3

ì·¨ë¯¸ë¡œ Rustë¥¼ ê³µë¶€í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ì œ ì–´ëŠ ì •ë„ ê¸°ë³¸ì ì¸ ë¬¸ë²•ì„ ìµí˜”ê³ , Rustì½”ë“œë¥¼ ì¡°ê¸ˆì€ ì½ì„ ìˆ˜ ìˆê²Œë˜ì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ Rustë¡œ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§Œë“¤ê¸° `Hello World` ì •ë„ë¥¼ í•œ ë²ˆ í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤. ê·¸ëŸ¬ê¸° ìœ„í•´ì„œëŠ” `PyO3` í¬ë ˆì´íŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.

`PyO3`ì€ Rustì™€ Pythonì„ ìƒí˜¸ ì—°ê²°í•´ì£¼ëŠ” ë‹¤ë¦¬ê°™ì€ ì—­í• ì„ í•˜ëŠ” í¬ë ˆì´íŠ¸ë¼ê³  ë³´ë©´ ë©ë‹ˆë‹¤. Rustë¡œ ì‘ì„±í•œ ì½”ë“œë¥¼ Pythonì—ì„œ ì‚¬ìš©í•˜ê²Œ í•´ì¤ë‹ˆë‹¤. ê·¸ ë°˜ëŒ€ë¡œë„ ë©ë‹ˆë‹¤.

`PyO3`ì˜ ë¬¸ì„œë¥¼ ë³´ë©´ì„œ ë„ì ë„ì  í•´ë³´ì•˜ìŠµë‹ˆë‹¤.

<Link url="https://pyo3.rs/v0.21.2/" />

## Maturin

`PyO3`ë§Œ í•„ìš”í•œê²Œ ì•„ë‹ˆì—ˆìŠµë‹ˆë‹¤. Rust í¬ë ˆì´íŠ¸ë¥¼ Python íŒ¨í‚¤ì§€ë¡œ ë¹Œë“œí•´ì£¼ëŠ” íˆ´ì´ í•„ìš”í•œë°ìš”. ë°”ë¡œ `Maturin` ì…ë‹ˆë‹¤.

`Maturin`ì„ ì‚¬ìš©í•˜ë©´ Rustë¡œ ì‘ì„±ëœ ì½”ë“œë¥¼ ì†ì‰½ê²Œ Python íŒ¨í‚¤ì§€ë¡œ ë³€í™˜í•˜ì—¬ PyPIì— ë°°í¬í•˜ê±°ë‚˜, ë¡œì»¬ ê°œë°œ í™˜ê²½ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<Link url="https://www.maturin.rs/installation" />

## Maturin ì„¤ì¹˜í•˜ê¸°

ê°€ì¥ ë¨¼ì €í•  ê²ƒì€ `Maturin` ì„¤ì¹˜í•˜ê¸° ì…ë‹ˆë‹¤. MacOS ê¸°ì¤€ `Homebrew`ë¥¼ ì´ìš©í•´ì„œ ì„¤ì¹˜í•˜ë©´ ë©ë‹ˆë‹¤.

```python
brew install maturin
```

## í”„ë¡œì íŠ¸ ì…‹ì—…í•˜ê¸°

- Pythonì—ì„œ ê°€ìƒ í™˜ê²½ì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.

```bash
python3 -m venv .venv

sourse .venv/bin/activate
```

- Rust í”„ë¡œì íŠ¸ ìƒì„±
  - cargoë¥¼ ì´ìš©í•´ë„ ë˜ì§€ë§Œ `maturin`ìœ¼ë¡œ ë§ì¶¤ìœ¼ë¡œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
maturin init

# pyo3 ì„ íƒ
? ğŸ¤· Which kind of bindings to use?
  ğŸ“– Documentation: https://maturin.rs/bindings.html â€º
â¯ pyo3
  rust-cpython
  cffi
  uniffi
  bin


# .gitignore, Cargo.toml, pyproject.toml, src/, .github/ê°€ ìƒì„±ë©ë‹ˆë‹¤.
```

- `Cargo.toml`ê³¼ `pyproject.toml`ì— ê¸°ë³¸ì ì¸ ì •ë³´ê°€ ì…‹íŒ…ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

## ì½”ë“œ ì‘ì„±í•˜ê¸°

ìƒì„±ëœ `src`ì•ˆì— `lib.rs` ê°€ ìƒì„±ë˜ëŠ”ë° ê·¸ê³³ì— ì½”ë“œë¥¼ ì‘ì„±í•´ì¤ë‹ˆë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ `hello world` ê¸‰ ì½”ë“œê°€ ì‘ì„±ë˜ì–´ ìˆëŠ”ë° ì§€ìš°ê³  ëœë¤í•œ ë¬¸ìì—´ì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ë³´ì•˜ìŠµë‹ˆë‹¤. (30ë¶„ ì´ìƒê±¸ë¦¼.. pythonìœ¼ë¡œ ì‘ì„±í•˜ë©´ 30ì´ˆë©´ ë  ê²ƒì„..)

```bash
cargo add rand
```

```rust
use pyo3::prelude::*;
use rand::seq::SliceRandom;
use rand::thread_rng;
use rand::distributions::{Alphanumeric, DistString};

const PUNCTUATION: &str = "!@#$%^&*()_+-=[]{}|;:'\",.<>/?";

fn _generate_random_string(max_length: usize) -> String {
    let mut rng = thread_rng();

    let charset: Vec<char> = Alphanumeric
        .sample_string(&mut rng, max_length)
        .chars()
        .chain(PUNCTUATION.chars())
        .collect();

    let result: String = (0..max_length)
        .map(|_| {
            *charset.choose(&mut rng).unwrap()
        })
        .collect();

    result
}

#[pyfunction]
fn generate_random_string(max_length: usize) -> PyResult<String> {
    Ok(_generate_random_string(max_length))
}

/// A Python module implemented in Rust.
#[pymodule]
fn py_rust(m: &Bound<'_, PyModule>) -> PyResult<()> {
    m.add_function(wrap_pyfunction!(generate_random_string, m)?)?;
    Ok(())
}

```

- `#[pyfunction]` ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ê°ì‹¸ì§„ í•¨ìˆ˜ê°€ pythonì—ì„œ í•¨ìˆ˜ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.
- `#[pymodule]` ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ê°ì‹¸ì§„ í•¨ìˆ˜ê°€ moduleì„ ì„ ì–¸í•˜ëŠ” ê²ƒì´ì£ 
- ì—¬ê¸°ì„œ êµ¬í˜„ì€ ì•ˆí–ˆì§€ë§Œ classë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” structë¥¼ ë§Œë“¤ì–´ `#[pyclass]` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- í´ë˜ìŠ¤ì˜ methodëŠ” impl ë¸”ë¡ ì•ˆì— êµ¬í˜„í•˜ê³  `#[pymethods]` ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ìœ„ ì˜ˆì œì—ì„œëŠ” íŒŒì´ì¬ì—ì„œ `from py_rust import generate_random_string` ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê² ìŠµë‹ˆë‹¤.

ì•„ë¬´íŠ¼ ìœ„ì— ì‘ì„±í•œ í•¨ìˆ˜ëŠ” ê¸¸ì´ë¥¼ ì…ë ¥ë°›ì•„ ëœë¤í•œ ë¬¸ìì—´ì„ ìƒì„±í•©ë‹ˆë‹¤.

## ë¹Œë“œí•˜ê¸°

`maturin`ì„ ì´ìš©í•˜ì—¬ pythoníŒ¨í‚¤ì§€ë¡œ ë¹Œë“œí•˜ê³  ê°€ìƒí™˜ê²½ì— ì„¤ì¹˜í•©ë‹ˆë‹¤.

ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ ì—¬ëŸ¬ Warningì´ ë‚˜ì™”ëŠ”ë°, ì½ì–´ë³´ê³  í•´ê²°í–ˆë”ë‹ˆ Warningì—†ì´ ë‹¤ìŒê³¼ ê°™ì´ ì˜ ë¹Œë“œê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.

```bash
maturin develop

py-rust maturin develop
ğŸ”— Found pyo3 bindings
ğŸ Found CPython 3.12 at /Users/minchae/DEV/projects/rust/py-rust/.venv/bin/python
ğŸ“¡ Using build options features from pyproject.toml
   Compiling py-rust v0.1.0 (/Users/minchae/DEV/projects/rust/py-rust)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.43s
ğŸ“¦ Built wheel for CPython 3.12 to /var/folders/0t/b2cf43fs7154b6jb9mdc549w0000gn/T/.tmpDQ7jCD/py_rust-0.1.0-cp312-cp312-macosx_10_12_x86_64.whl
âœï¸  Setting installed package as editabl
```

## Pythonì—ì„œ ì‹¤í–‰í•´ë³´ê¸°

- ì½”ë“œ

```python
import py_rust

print(py_rust.generate_random_string(30))
```

- ì‹¤í–‰

```bash
python main.py

W@)TX@]_^#{l[AG&<G(<E*3IEc{}!}
```

ì™€ìš° ì‹ ê¸°í•´!

## ë§ˆë¬´ë¦¬

Rustê³µë¶€í•˜ê¸° ì‹œì‘í•˜ë©´ì„œ, ê³µë¶€í•´ì„œ Python ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë§Œë“¤ê³  ì‹¶ë‹¤ê³  ìƒê°í–ˆì—ˆìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ Hello Worldë¥¼ í•´ë³¸ ê¸°ë¶„ì¸ë°ìš”. ì•„ì§ ê°ˆê¸¸ì´ ë©€ì§€ë§Œ ì´ë ‡ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ë‹ˆ ì •ë§ ì–´ë µì§€ë§Œ ì¬ë°ŒìŠµë‹ˆë‹¤.

<Link url="https://chaechae.life/blog/rust-struct-implementation" />
